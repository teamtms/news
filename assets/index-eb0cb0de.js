import{j as e,C as B,u as C,w as i}from"./index-565c6b92.js";import{P as v,g as S}from"./index-1bd9c913.js";import{I as o}from"./index-85abbd52.js";import{u as c}from"./useQuery-ab070b3a.js";const F="_posts_jq6ea_1",P="_postsContainer_jq6ea_8",_={posts:F,postsContainer:P},R={},w=s=>e.jsx("h2",{className:R.title2,children:s.children}),E="_image_ke62f_1",T="_imageContainer_ke62f_7",D="_noRound_ke62f_18",L="_container_ke62f_22",M="_card_ke62f_30",z="_upper_ke62f_40",q="_info_ke62f_44",H="_infoBlock_ke62f_51",n={image:E,imageContainer:T,noRound:D,container:L,card:M,upper:z,info:q,infoBlock:H},O="_breadcrumbs_zki2p_1",A="_breadcrumb_zki2p_1",Q="_link_zki2p_21",u={breadcrumbs:O,breadcrumb:A,link:Q},U=({items:s,className:t,...d})=>e.jsx("ul",{className:`${u.breadcrumbs} ${t}`,...d,children:s.map((r,a)=>e.jsx("li",{className:u.breadcrumb,children:a===s.length-1?r.name:e.jsxs(e.Fragment,{children:[e.jsx("a",{href:r.url,className:u.link,children:r.name})," ",e.jsx(o,{icon:"chevron_right"})]})},a))}),G=s=>e.jsxs(e.Fragment,{children:[s.appearance==="1"?e.jsx("img",{src:s.image,className:`${n.image} ${n.noRound}`,alt:""}):"",(s.appearance==="2",""),s.appearance==="3"||s.appearance==="2"?e.jsx("div",{className:`container ${n.imageContainer}`,children:e.jsx("img",{src:s.image,className:n.image,alt:""})}):"",e.jsxs(B,{className:`container 
				${s.appearance==="1"?n.upper:""}  
				${s.appearance!=="2"?n.card:""}
				${n.container}`,children:[e.jsx(U,{items:[{name:"Главная",url:"/"},{name:s.title,url:"#"}]}),e.jsx("h1",{children:s.title}),e.jsxs("div",{className:n.info,children:[e.jsxs("div",{className:n.infoBlock,children:[e.jsx(o,{icon:"person"}),s.author]}),e.jsxs("div",{className:n.infoBlock,children:[e.jsx(o,{icon:"calendar_month"}),s.date]}),e.jsxs("div",{className:n.infoBlock,children:[e.jsx(o,{icon:"push_pin"}),e.jsx("a",{className:n.link,href:`#/posts/${s.categoryId}`,children:s.category})]})]}),e.jsx("div",{className:n.article,dangerouslySetInnerHTML:{__html:s.content}}),e.jsxs("div",{className:n.infoBlock,children:[e.jsx(o,{icon:"sell"})," ",s.tags]})]})]}),J=async s=>{console.log("fetching image");const{data:t}=await i.getMediaById(s);return t},K=async s=>{const{data:t}=await i.getUserById(s);return t},V=async s=>{const{data:t}=await i.getHeadingById(s);return t},ee=()=>{const s=C(),{isSuccess:t,isError:d,isLoading:r,data:a,error:f}=c(["post"],()=>i.getPostById(Number(s.id))),{isLoading:j,isError:x,error:p,data:m,isSuccess:k}=c(["catalog"],()=>i.getPosts(),{refetchOnMount:!0}),{data:y,isSuccess:b}=c(["author"],()=>K(a==null?void 0:a.data.author),{enabled:!!(a!=null&&a.data.author)}),{data:g,isSuccess:I}=c(["category"],()=>V(a==null?void 0:a.data.categories[0]),{enabled:!!(a!=null&&a.data.categories)}),{data:N,isSuccess:$}=c(["image"],()=>J(a==null?void 0:a.data.featured_media),{enabled:!!(a!=null&&a.data.featured_media),refetchInterval:6e4,refetchOnMount:!0});return d||x?(console.log(f),console.log(p),e.jsx(e.Fragment,{children:"Ошибка. См. подробности в консоли"})):r||j?e.jsx(e.Fragment,{children:"Подождите..."}):!t||!k||!b||!I?e.jsx(e.Fragment,{children:"Неизвестная ошибка"}):e.jsxs(e.Fragment,{children:[e.jsx(G,{appearance:a.data.acf.appearance,title:a==null?void 0:a.data.title.rendered,content:a==null?void 0:a.data.content.rendered,author:y.name,date:`${a==null?void 0:a.data.date.split("T")[0].split("-")[2]}.
								 ${a==null?void 0:a.data.date.split("T")[0].split("-")[1]}.
								 ${a==null?void 0:a.data.date.split("T")[0].split("-")[0]}`,id:a.data.id,category:g.name,categoryId:g.id,tags:a.data.acf.tags,image:$?N.guid.rendered:"#"}),e.jsx("div",{className:_.posts,children:e.jsxs("div",{className:`container ${_.postsContainer}`,children:[e.jsx(w,{children:"Последние статьи"}),m==null?void 0:m.data.map((l,h)=>e.jsx(e.Fragment,{children:h<3?e.jsx(v,{title:l.title.rendered,excerpt:l.excerpt.rendered,url:`?${S(512)}/#/p/${l.id}`,image:"",tags:l.acf.tags},h):""}))]})})]})};export{ee as default};
